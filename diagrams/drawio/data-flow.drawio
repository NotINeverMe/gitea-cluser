<mxfile host="app.diagrams.net" modified="2025-10-09T19:14:56Z" agent="mxGraph" version="22.1.4" type="device">
  <diagram name="Data Flow" id="6115F853E24D40ABA4926A4805CACAA2">
    <mxGraphModel dx="1024" dy="768" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>
        <mxCell id="2" value="%%{init: {&#x27;theme&#x27;:&#x27;base&#x27;, &#x27;themeVariables&#x27;: { &#x27;primaryColor&#x27;:&#x27;#e3f2fd&#x27;,&#x27;secondaryColor&#x27;:&#x27;#fff3e0&#x27;,&#x27;tertiaryColor&#x27;:&#x27;#f3e5f5&#x27;}}}%%&#xa;&#xa;graph TB&#xa;    %% Actors&#xa;    DEV[&quot;Developer&lt;br/&gt;A-1&quot;]&#xa;    ADMIN[&quot;Administrator&lt;br/&gt;A-1&quot;]&#xa;&#xa;    %% Application Components&#xa;    GITEA[&quot;A-6: Gitea&lt;br/&gt;[CUI]&quot;]&#xa;    N8N[&quot;A-7: n8n&lt;br/&gt;[SPA]&quot;]&#xa;    SONAR[&quot;A-8: SonarQube&lt;br/&gt;[SPA]&quot;]&#xa;    PROM[&quot;A-9: Prometheus&lt;br/&gt;[SPA]&quot;]&#xa;    GRAF[&quot;A-10: Grafana&lt;br/&gt;[SPA]&quot;]&#xa;&#xa;    %% Data Stores&#xa;    GITEADB[&quot;S-1: Gitea DB&lt;br/&gt;[CUI]&lt;br/&gt;AES-256-GCM&quot;]&#xa;    SONARDB[&quot;S-2: Sonar DB&lt;br/&gt;[SPA]&lt;br/&gt;AES-256-GCM&quot;]&#xa;    N8NDB[&quot;S-3: n8n DB&lt;br/&gt;[SPA]&lt;br/&gt;AES-256-GCM&quot;]&#xa;    PROMDB[&quot;S-4: Prom TSDB&lt;br/&gt;[SPA]&quot;]&#xa;&#xa;    %% Security Scanners&#xa;    TRIVY[&quot;A-11: Trivy&lt;br/&gt;[SPC]&quot;]&#xa;    GRYPE[&quot;A-12: Grype&lt;br/&gt;[SPC]&quot;]&#xa;    SEMGREP[&quot;A-13: Semgrep&lt;br/&gt;[SPC]&quot;]&#xa;    CHECKOV[&quot;A-14: Checkov&lt;br/&gt;[SPC]&quot;]&#xa;    TFSEC[&quot;A-15: tfsec&lt;br/&gt;[SPC]&quot;]&#xa;    TERRASCAN[&quot;A-16: Terrascan&lt;br/&gt;[SPC]&quot;]&#xa;    INFRACOST[&quot;A-17: Infracost&lt;br/&gt;[SPC]&quot;]&#xa;&#xa;    %% GCP Services&#xa;    GCS[&quot;S-5: GCS Evidence&lt;br/&gt;[CRMA]&lt;br/&gt;Immutable&quot;]&#xa;    SCC[&quot;A-18: Security&lt;br/&gt;Command Center&quot;]&#xa;    CAI[&quot;A-19: Cloud Asset&lt;br/&gt;Inventory&quot;]&#xa;    LOGGING[&quot;A-20: Cloud Logging&quot;]&#xa;    CHAT[&quot;A-21: Google Chat&quot;]&#xa;&#xa;    %% External Services&#xa;    CVEDB[&quot;A-2: CVE Databases&lt;br/&gt;[External]&quot;]&#xa;&#xa;    %% Flow 1: Code Commit and Security Scanning&#xa;    DEV --&gt;|F-1: Git Push&lt;br/&gt;SSH/22&lt;br/&gt;Public Key Auth&lt;br/&gt;Data: Source Code [CUI]| GITEA&#xa;    GITEA --&gt;|F-11: Store Code&lt;br/&gt;PostgreSQL/5432&lt;br/&gt;TLS + Certificate&lt;br/&gt;Data: Repositories [CUI]| GITEADB&#xa;    GITEA --&gt;|F-15: Webhook Trigger&lt;br/&gt;HTTP POST&lt;br/&gt;HMAC-SHA256&lt;br/&gt;Data: Event Metadata| N8N&#xa;&#xa;    N8N --&gt;|F-21: Spawn Scanner&lt;br/&gt;Docker Socket&lt;br/&gt;Unix Domain&lt;br/&gt;Data: Code Snapshot| TRIVY&#xa;    N8N --&gt;|F-22: Spawn Scanner&lt;br/&gt;Docker Socket&lt;br/&gt;Unix Domain&lt;br/&gt;Data: Code Snapshot| GRYPE&#xa;    N8N --&gt;|F-23: Spawn Scanner&lt;br/&gt;Docker Socket&lt;br/&gt;Unix Domain&lt;br/&gt;Data: Code Snapshot| SEMGREP&#xa;&#xa;    TRIVY --&gt;|F-28: Update CVE DB&lt;br/&gt;HTTPS/443&lt;br/&gt;TLS 1.3&lt;br/&gt;Data: Vulnerability Signatures| CVEDB&#xa;    GRYPE --&gt;|F-29: Update Grype DB&lt;br/&gt;HTTPS/443&lt;br/&gt;TLS 1.3&lt;br/&gt;Data: Vulnerability Signatures| CVEDB&#xa;&#xa;    TRIVY --&gt;|F-36: Scan Results&lt;br/&gt;JSON Response&lt;br/&gt;In-Memory&lt;br/&gt;Data: CVE List [CUI]| N8N&#xa;    GRYPE --&gt;|F-37: Scan Results&lt;br/&gt;JSON Response&lt;br/&gt;In-Memory&lt;br/&gt;Data: SBOM + CVEs [CUI]| N8N&#xa;    SEMGREP --&gt;|F-38: Scan Results&lt;br/&gt;JSON Response&lt;br/&gt;In-Memory&lt;br/&gt;Data: SAST Findings [CUI]| N8N&#xa;&#xa;    %% Flow 2: SAST Integration&#xa;    N8N --&gt;|F-16: Trigger Analysis&lt;br/&gt;HTTP/9000&lt;br/&gt;API Token&lt;br/&gt;Data: Project Key| SONAR&#xa;    SONAR --&gt;|F-12: Store Results&lt;br/&gt;PostgreSQL/5432&lt;br/&gt;TLS + Certificate&lt;br/&gt;Data: Quality Metrics [CUI]| SONARDB&#xa;    SONAR --&gt;|F-39: Analysis Results&lt;br/&gt;HTTP/9000&lt;br/&gt;API Token&lt;br/&gt;Data: Code Smells, Bugs [CUI]| N8N&#xa;&#xa;    %% Flow 3: IaC Security Scanning&#xa;    DEV --&gt;|F-40: Terraform Commit&lt;br/&gt;SSH/22&lt;br/&gt;Public Key Auth&lt;br/&gt;Data: IaC Files [CUI]| GITEA&#xa;    GITEA --&gt;|F-41: Webhook Trigger&lt;br/&gt;HTTP POST&lt;br/&gt;HMAC-SHA256&lt;br/&gt;Data: IaC Change Event| N8N&#xa;&#xa;    N8N --&gt;|F-24: Mount IaC Files&lt;br/&gt;Docker Exec&lt;br/&gt;Volume Mount&lt;br/&gt;Data: Terraform Code [CUI]| CHECKOV&#xa;    N8N --&gt;|F-25: Mount IaC Files&lt;br/&gt;Docker Exec&lt;br/&gt;Volume Mount&lt;br/&gt;Data: Terraform Code [CUI]| TFSEC&#xa;    N8N --&gt;|F-26: Mount IaC Files&lt;br/&gt;Docker Exec&lt;br/&gt;Volume Mount&lt;br/&gt;Data: Terraform Code [CUI]| TERRASCAN&#xa;    N8N --&gt;|F-27: Mount IaC Files&lt;br/&gt;Docker Exec&lt;br/&gt;Volume Mount&lt;br/&gt;Data: Terraform Code [CUI]| INFRACOST&#xa;&#xa;    CHECKOV --&gt;|F-42: Security Findings&lt;br/&gt;JSON Response&lt;br/&gt;In-Memory&lt;br/&gt;Data: Policy Violations [CUI]| N8N&#xa;    TFSEC --&gt;|F-43: Security Findings&lt;br/&gt;JSON Response&lt;br/&gt;In-Memory&lt;br/&gt;Data: Security Issues [CUI]| N8N&#xa;    TERRASCAN --&gt;|F-44: Compliance Findings&lt;br/&gt;JSON Response&lt;br/&gt;In-Memory&lt;br/&gt;Data: Compliance Gaps [CUI]| N8N&#xa;    INFRACOST --&gt;|F-45: Cost Analysis&lt;br/&gt;JSON Response&lt;br/&gt;In-Memory&lt;br/&gt;Data: Cost Breakdown| N8N&#xa;&#xa;    %% Flow 4: Evidence Collection and Storage&#xa;    N8N --&gt;|F-46: Hash Evidence&lt;br/&gt;SHA-256&lt;br/&gt;In-Process&lt;br/&gt;Data: Scan Results [CUI]| N8N&#xa;    N8N --&gt;|F-30: Upload Evidence&lt;br/&gt;HTTPS/443&lt;br/&gt;Service Account OAuth2&lt;br/&gt;AES-256-GCM&lt;br/&gt;Data: Evidence Package [CUI]| GCS&#xa;    N8N --&gt;|F-13: Store Workflow State&lt;br/&gt;PostgreSQL/5432&lt;br/&gt;TLS + Certificate&lt;br/&gt;Data: Execution Logs [SPA]| N8NDB&#xa;&#xa;    %% Flow 5: GCP Security Integration&#xa;    N8N --&gt;|F-31: Query Findings&lt;br/&gt;HTTPS/443&lt;br/&gt;Service Account OAuth2&lt;br/&gt;TLS 1.3&lt;br/&gt;Data: Finding Queries| SCC&#xa;    N8N --&gt;|F-32: Discover Assets&lt;br/&gt;HTTPS/443&lt;br/&gt;Service Account OAuth2&lt;br/&gt;TLS 1.3&lt;br/&gt;Data: Asset Queries| CAI&#xa;&#xa;    SCC --&gt;|F-35: Push Findings&lt;br/&gt;Pub/Sub HTTPS/443&lt;br/&gt;JWT Authentication&lt;br/&gt;TLS 1.3&lt;br/&gt;Data: Security Findings [CUI]| N8N&#xa;&#xa;    N8N --&gt;|F-47: Map to Controls&lt;br/&gt;In-Process&lt;br/&gt;NIST 800-171 Mapping&lt;br/&gt;Data: Control Evidence [CUI]| N8N&#xa;    N8N --&gt;|F-48: Upload Control Map&lt;br/&gt;HTTPS/443&lt;br/&gt;Service Account OAuth2&lt;br/&gt;AES-256-GCM&lt;br/&gt;Data: Compliance Manifest [CUI]| GCS&#xa;&#xa;    %% Flow 6: Audit Logging&#xa;    N8N --&gt;|F-33: Write Audit Logs&lt;br/&gt;HTTPS/443&lt;br/&gt;Service Account OAuth2&lt;br/&gt;TLS 1.3&lt;br/&gt;Data: Audit Events [CUI]| LOGGING&#xa;    GITEA --&gt;|F-49: Write Audit Logs&lt;br/&gt;HTTPS/443&lt;br/&gt;Service Account OAuth2&lt;br/&gt;TLS 1.3&lt;br/&gt;Data: Access Events [CUI]| LOGGING&#xa;&#xa;    %% Flow 7: Notifications&#xa;    N8N --&gt;|F-34: Send Alert&lt;br/&gt;HTTPS/443&lt;br/&gt;Webhook Secret&lt;br/&gt;TLS 1.3&lt;br/&gt;Data: Alert Summary| CHAT&#xa;&#xa;    %% Flow 8: Monitoring and Metrics&#xa;    PROM --&gt;|F-17: Scrape Metrics&lt;br/&gt;HTTP/9090&lt;br/&gt;Service Discovery&lt;br/&gt;Data: Gitea Metrics| GITEA&#xa;    PROM --&gt;|F-18: Scrape Metrics&lt;br/&gt;HTTP/5678&lt;br/&gt;Service Discovery&lt;br/&gt;Data: n8n Metrics| N8N&#xa;    PROM --&gt;|F-19: Scrape Metrics&lt;br/&gt;HTTP/9000&lt;br/&gt;Service Discovery&lt;br/&gt;Data: Sonar Metrics| SONAR&#xa;    PROM --&gt;|F-14: Store Metrics&lt;br/&gt;Local Write&lt;br/&gt;Process Isolation&lt;br/&gt;Data: Time Series [SPA]| PROMDB&#xa;&#xa;    ADMIN --&gt;|F-50: View Dashboard&lt;br/&gt;HTTPS/443&lt;br/&gt;OAuth2 + MFA&lt;br/&gt;TLS 1.3&lt;br/&gt;Data: Visualizations| GRAF&#xa;    GRAF --&gt;|F-20: Query Metrics&lt;br/&gt;HTTP/9090&lt;br/&gt;Token Auth&lt;br/&gt;Data: PromQL Queries| PROM&#xa;&#xa;    %% Flow 9: Administrative Access&#xa;    ADMIN --&gt;|F-51: Admin Console&lt;br/&gt;SSH via VPN&lt;br/&gt;Certificate Auth&lt;br/&gt;MFA Required&lt;br/&gt;Data: Config Changes [CUI]| GITEA&#xa;    ADMIN --&gt;|F-52: Admin Console&lt;br/&gt;SSH via VPN&lt;br/&gt;Certificate Auth&lt;br/&gt;MFA Required&lt;br/&gt;Data: Workflow Config [SPA]| N8N&#xa;&#xa;    %% Styling&#xa;    classDef cui fill:#e3f2fd,stroke:#1976d2,stroke-width:3px,color:#000&#xa;    classDef spa fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#000&#xa;    classDef crma fill:#e8f5e9,stroke:#388e3c,stroke-width:3px,color:#000&#xa;    classDef spc fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000&#xa;    classDef ext fill:#fff9c4,stroke:#f9a825,stroke-width:2px,color:#000&#xa;    classDef actor fill:#fafafa,stroke:#424242,stroke-width:2px,color:#000&#xa;&#xa;    class GITEA,GITEADB cui&#xa;    class N8N,SONAR,PROM,GRAF,SONARDB,N8NDB,PROMDB spa&#xa;    class GCS crma&#xa;    class TRIVY,GRYPE,SEMGREP,CHECKOV,TFSEC,TERRASCAN,INFRACOST spc&#xa;    class SCC,CAI,LOGGING,CHAT,CVEDB ext&#xa;    class DEV,ADMIN actor" style="shape=mxgraph.mermaid;html=1;verticalAlign=top;align=left;whiteSpace=wrap;labelBackgroundColor=none;" vertex="1" parent="1">
          <mxGeometry x="20" y="20" width="800" height="600" as="geometry"/>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
