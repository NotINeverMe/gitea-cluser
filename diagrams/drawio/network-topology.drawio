<mxfile host="app.diagrams.net" modified="2025-10-09T19:14:56Z" agent="mxGraph" version="22.1.4" type="device">
  <diagram name="Network Topology" id="B808348AD6204E2085AA344AF1594467">
    <mxGraphModel dx="1024" dy="768" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>
        <mxCell id="2" value="%%{init: {&#x27;theme&#x27;:&#x27;base&#x27;, &#x27;themeVariables&#x27;: { &#x27;primaryColor&#x27;:&#x27;#e3f2fd&#x27;,&#x27;secondaryColor&#x27;:&#x27;#fff3e0&#x27;}}}%%&#xa;&#xa;graph TB&#xa;    subgraph INTERNET[&quot;INTERNET (0.0.0.0/0)&quot;]&#xa;        style INTERNET fill:#ffebee,stroke:#d32f2f,stroke-width:3px&#xa;        USER[&quot;End Users&lt;br/&gt;Dynamic IPs&quot;]&#xa;        GCP_PUB[&quot;GCP Public APIs&lt;br/&gt;googleapis.com&quot;]&#xa;        REGISTRY[&quot;Docker Hub&lt;br/&gt;registry-1.docker.io&quot;]&#xa;    end&#xa;&#xa;    subgraph HOST[&quot;Host System (Physical/VM)&quot;]&#xa;        style HOST fill:#f5f5f5,stroke:#616161,stroke-width:3px&#xa;&#xa;        subgraph DMZ_NET[&quot;Docker Network: dmz-network&lt;br/&gt;10.10.1.0/24&quot;]&#xa;            style DMZ_NET fill:#fff3e0,stroke:#f57c00,stroke-width:2px&#xa;            CADDY[&quot;Caddy Proxy&lt;br/&gt;10.10.1.10&lt;br/&gt;Ports: 80→443&quot;]&#xa;            VPN[&quot;VPN Gateway&lt;br/&gt;10.10.1.5&lt;br/&gt;Port: 51820&quot;]&#xa;        end&#xa;&#xa;        subgraph APP_NET[&quot;Docker Network: app-tier&lt;br/&gt;10.10.2.0/24&quot;]&#xa;            style APP_NET fill:#e3f2fd,stroke:#1976d2,stroke-width:3px&#xa;            GITEA_APP[&quot;Gitea&lt;br/&gt;10.10.2.10&lt;br/&gt;Port: 3000&quot;]&#xa;            N8N_APP[&quot;n8n&lt;br/&gt;10.10.2.20&lt;br/&gt;Port: 5678&quot;]&#xa;            SONAR_APP[&quot;SonarQube&lt;br/&gt;10.10.2.30&lt;br/&gt;Port: 9000&quot;]&#xa;        end&#xa;&#xa;        subgraph MON_NET[&quot;Docker Network: monitoring&lt;br/&gt;10.10.5.0/24&quot;]&#xa;            style MON_NET fill:#e8f5e9,stroke:#388e3c,stroke-width:2px&#xa;            PROM_APP[&quot;Prometheus&lt;br/&gt;10.10.5.10&lt;br/&gt;Port: 9090&quot;]&#xa;            GRAF_APP[&quot;Grafana&lt;br/&gt;10.10.5.20&lt;br/&gt;Port: 3001&quot;]&#xa;        end&#xa;&#xa;        subgraph DATA_NET[&quot;Docker Network: data-tier&lt;br/&gt;10.10.3.0/24 (Isolated)&quot;]&#xa;            style DATA_NET fill:#e8f5e9,stroke:#2e7d32,stroke-width:4px&#xa;            PG_GITEA[&quot;PostgreSQL&lt;br/&gt;10.10.3.10&lt;br/&gt;Port: 5432&lt;br/&gt;Volume: gitea-db-vol&quot;]&#xa;            PG_SONAR[&quot;PostgreSQL&lt;br/&gt;10.10.3.20&lt;br/&gt;Port: 5432&lt;br/&gt;Volume: sonar-db-vol&quot;]&#xa;            PG_N8N[&quot;PostgreSQL&lt;br/&gt;10.10.3.30&lt;br/&gt;Port: 5432&lt;br/&gt;Volume: n8n-db-vol&quot;]&#xa;            PROM_TSDB[&quot;Prometheus TSDB&lt;br/&gt;10.10.3.40&lt;br/&gt;Volume: prom-data-vol&quot;]&#xa;        end&#xa;&#xa;        subgraph SCAN_NET[&quot;Docker Network: scan-tier&lt;br/&gt;10.10.4.0/24 (Ephemeral)&quot;]&#xa;            style SCAN_NET fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px&#xa;            TRIVY_POD[&quot;Trivy Container&lt;br/&gt;Dynamic IP&lt;br/&gt;Lifecycle: On-Demand&quot;]&#xa;            GRYPE_POD[&quot;Grype Container&lt;br/&gt;Dynamic IP&lt;br/&gt;Lifecycle: On-Demand&quot;]&#xa;            SEMGREP_POD[&quot;Semgrep Container&lt;br/&gt;Dynamic IP&lt;br/&gt;Lifecycle: On-Demand&quot;]&#xa;            CHECKOV_POD[&quot;Checkov Container&lt;br/&gt;Dynamic IP&lt;br/&gt;Lifecycle: On-Demand&quot;]&#xa;        end&#xa;&#xa;        DOCKER_SOCK[&quot;Docker Socket&lt;br/&gt;/var/run/docker.sock&quot;]&#xa;        VOLUMES[&quot;Encrypted Volumes&lt;br/&gt;LUKS + AES-256-GCM&quot;]&#xa;    end&#xa;&#xa;    subgraph FIREWALL[&quot;Host Firewall Rules (iptables/nftables)&quot;]&#xa;        style FIREWALL fill:#fff9c4,stroke:#f57c00,stroke-width:2px&#xa;        FW1[&quot;ACCEPT: 443/tcp → 10.10.1.10&quot;]&#xa;        FW2[&quot;ACCEPT: 51820/udp → 10.10.1.5&quot;]&#xa;        FW3[&quot;ACCEPT: Established/Related&quot;]&#xa;        FW4[&quot;DROP: All other ingress&quot;]&#xa;        FW5[&quot;ACCEPT: 10.10.0.0/16 → 10.10.0.0/16&quot;]&#xa;        FW6[&quot;REJECT: 10.10.3.0/24 → 0.0.0.0/0&quot;]&#xa;        FW7[&quot;ACCEPT: 10.10.4.0/24 → GCP APIs&quot;]&#xa;    end&#xa;&#xa;    %% External to DMZ&#xa;    USER --&gt;|&quot;HTTPS/443&lt;br/&gt;TLS 1.3&quot;| FW1&#xa;    FW1 --&gt;|&quot;Port Forward&quot;| CADDY&#xa;    USER --&gt;|&quot;WireGuard/51820&lt;br/&gt;Encrypted Tunnel&quot;| FW2&#xa;    FW2 --&gt;|&quot;Port Forward&quot;| VPN&#xa;&#xa;    %% DMZ to App Tier&#xa;    CADDY --&gt;|&quot;HTTP/3000&lt;br/&gt;Reverse Proxy&quot;| GITEA_APP&#xa;    CADDY --&gt;|&quot;HTTP/5678&lt;br/&gt;Reverse Proxy&quot;| N8N_APP&#xa;    CADDY --&gt;|&quot;HTTP/9000&lt;br/&gt;Reverse Proxy&quot;| SONAR_APP&#xa;    CADDY --&gt;|&quot;HTTP/3001&lt;br/&gt;Reverse Proxy&quot;| GRAF_APP&#xa;&#xa;    VPN --&gt;|&quot;VPN Tunnel&lt;br/&gt;Admin Access&quot;| GITEA_APP&#xa;    VPN --&gt;|&quot;VPN Tunnel&lt;br/&gt;Admin Access&quot;| N8N_APP&#xa;&#xa;    %% App to Data Tier&#xa;    GITEA_APP --&gt;|&quot;PostgreSQL/5432&lt;br/&gt;TLS Connection&quot;| PG_GITEA&#xa;    SONAR_APP --&gt;|&quot;PostgreSQL/5432&lt;br/&gt;TLS Connection&quot;| PG_SONAR&#xa;    N8N_APP --&gt;|&quot;PostgreSQL/5432&lt;br/&gt;TLS Connection&quot;| PG_N8N&#xa;    PROM_APP --&gt;|&quot;Local Write&lt;br/&gt;Unix Socket&quot;| PROM_TSDB&#xa;&#xa;    %% App to Monitoring&#xa;    PROM_APP --&gt;|&quot;Scrape/9090&lt;br/&gt;Service Discovery&quot;| GITEA_APP&#xa;    PROM_APP --&gt;|&quot;Scrape/5678&lt;br/&gt;Service Discovery&quot;| N8N_APP&#xa;    PROM_APP --&gt;|&quot;Scrape/9000&lt;br/&gt;Service Discovery&quot;| SONAR_APP&#xa;    GRAF_APP --&gt;|&quot;Query/9090&lt;br/&gt;PromQL&quot;| PROM_APP&#xa;&#xa;    %% App to Scan Tier&#xa;    N8N_APP --&gt;|&quot;Docker Socket&lt;br/&gt;Container Spawn&quot;| DOCKER_SOCK&#xa;    DOCKER_SOCK --&gt;|&quot;Create&quot;| TRIVY_POD&#xa;    DOCKER_SOCK --&gt;|&quot;Create&quot;| GRYPE_POD&#xa;    DOCKER_SOCK --&gt;|&quot;Create&quot;| SEMGREP_POD&#xa;    DOCKER_SOCK --&gt;|&quot;Create&quot;| CHECKOV_POD&#xa;&#xa;    %% Scan to Internet&#xa;    TRIVY_POD --&gt;|&quot;HTTPS/443&lt;br/&gt;CVE DB Update&quot;| GCP_PUB&#xa;    GRYPE_POD --&gt;|&quot;HTTPS/443&lt;br/&gt;CVE DB Update&quot;| GCP_PUB&#xa;&#xa;    %% App to GCP&#xa;    N8N_APP --&gt;|&quot;HTTPS/443&lt;br/&gt;Service Account OAuth2&quot;| GCP_PUB&#xa;&#xa;    %% Registry Pull&#xa;    REGISTRY --&gt;|&quot;HTTPS/443&lt;br/&gt;Image Pull&quot;| CADDY&#xa;    CADDY --&gt;|&quot;Registry Proxy&quot;| GITEA_APP&#xa;&#xa;    %% Data Persistence&#xa;    PG_GITEA -.-&gt;|&quot;Encrypted Volume&quot;| VOLUMES&#xa;    PG_SONAR -.-&gt;|&quot;Encrypted Volume&quot;| VOLUMES&#xa;    PG_N8N -.-&gt;|&quot;Encrypted Volume&quot;| VOLUMES&#xa;    PROM_TSDB -.-&gt;|&quot;Encrypted Volume&quot;| VOLUMES&#xa;&#xa;    %% Network Isolation Annotations&#xa;    classDef dmz fill:#fff3e0,stroke:#f57c00,stroke-width:2px&#xa;    classDef app fill:#e3f2fd,stroke:#1976d2,stroke-width:2px&#xa;    classDef data fill:#e8f5e9,stroke:#2e7d32,stroke-width:3px&#xa;    classDef scan fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px&#xa;    classDef mon fill:#e8f5e9,stroke:#388e3c,stroke-width:2px&#xa;    classDef external fill:#ffebee,stroke:#d32f2f,stroke-width:2px&#xa;&#xa;    class CADDY,VPN dmz&#xa;    class GITEA_APP,N8N_APP,SONAR_APP app&#xa;    class PG_GITEA,PG_SONAR,PG_N8N,PROM_TSDB data&#xa;    class TRIVY_POD,GRYPE_POD,SEMGREP_POD,CHECKOV_POD scan&#xa;    class PROM_APP,GRAF_APP mon&#xa;    class USER,GCP_PUB,REGISTRY external" style="shape=mxgraph.mermaid;html=1;verticalAlign=top;align=left;whiteSpace=wrap;labelBackgroundColor=none;" vertex="1" parent="1">
          <mxGeometry x="20" y="20" width="800" height="600" as="geometry"/>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
