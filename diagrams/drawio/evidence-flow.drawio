<mxfile host="app.diagrams.net" modified="2025-10-09T19:14:56Z" agent="mxGraph" version="22.1.4" type="device">
  <diagram name="Evidence Flow" id="472C6A356B0149E2B68B5983AE3EAA71">
    <mxGraphModel dx="1024" dy="768" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>
        <mxCell id="2" value="%%{init: {&#x27;theme&#x27;:&#x27;base&#x27;, &#x27;themeVariables&#x27;: { &#x27;primaryColor&#x27;:&#x27;#e8f5e9&#x27;,&#x27;secondaryColor&#x27;:&#x27;#e3f2fd&#x27;}}}%%&#xa;&#xa;graph TB&#xa;    subgraph SCANNING[&quot;Security Scanning Phase&quot;]&#xa;        style SCANNING fill:#f3e5f5,stroke:#7b1fa2,stroke-width:3px&#xa;        TRIVY_SCAN[&quot;Trivy Scanner&lt;br/&gt;Container CVE Analysis&quot;]&#xa;        GRYPE_SCAN[&quot;Grype Scanner&lt;br/&gt;SBOM Generation&quot;]&#xa;        SEMGREP_SCAN[&quot;Semgrep&lt;br/&gt;SAST Analysis&quot;]&#xa;        CHECKOV_SCAN[&quot;Checkov&lt;br/&gt;IaC Security&quot;]&#xa;        TFSEC_SCAN[&quot;tfsec&lt;br/&gt;Terraform Security&quot;]&#xa;        SONAR_SCAN[&quot;SonarQube&lt;br/&gt;Code Quality&quot;]&#xa;    end&#xa;&#xa;    subgraph COLLECTION[&quot;Evidence Collection (n8n Workflow)&quot;]&#xa;        style COLLECTION fill:#e3f2fd,stroke:#1976d2,stroke-width:3px&#xa;        COLLECT[&quot;Collect Raw Results&lt;br/&gt;JSON Aggregation&quot;]&#xa;        ENRICH[&quot;Enrich Metadata&lt;br/&gt;Timestamp, Commit SHA,&lt;br/&gt;Repository, Branch&quot;]&#xa;        HASH[&quot;Generate SHA-256 Hash&lt;br/&gt;Evidence Integrity&quot;]&#xa;        MAP_CONTROLS[&quot;Map to NIST 800-171&lt;br/&gt;Control Evidence Matrix&quot;]&#xa;        MANIFEST[&quot;Generate Manifest&lt;br/&gt;Evidence Catalog&quot;]&#xa;    end&#xa;&#xa;    subgraph STORAGE[&quot;Evidence Storage (GCS)&quot;]&#xa;        style STORAGE fill:#e8f5e9,stroke:#2e7d32,stroke-width:4px&#xa;        GCS_RAW[&quot;gs://evidence-bucket/raw/&lt;br/&gt;YYYY/MM/DD/HH/&lt;br/&gt;{timestamp}-{hash}.json&lt;br/&gt;Storage Class: Archive&lt;br/&gt;Encryption: CMEK AES-256-GCM&quot;]&#xa;        GCS_MANIFEST[&quot;gs://evidence-bucket/manifests/&lt;br/&gt;YYYY/MM/&lt;br/&gt;{timestamp}-manifest.json&lt;br/&gt;Storage Class: Standard&lt;br/&gt;Encryption: CMEK AES-256-GCM&quot;]&#xa;        GCS_CONTROLS[&quot;gs://evidence-bucket/controls/&lt;br/&gt;NIST-800-171/&lt;br/&gt;{control-id}/&lt;br/&gt;{timestamp}-evidence.json&lt;br/&gt;Storage Class: Archive&lt;br/&gt;Encryption: CMEK AES-256-GCM&quot;]&#xa;    end&#xa;&#xa;    subgraph COMPLIANCE[&quot;Compliance &amp; Retention&quot;]&#xa;        style COMPLIANCE fill:#fff3e0,stroke:#f57c00,stroke-width:3px&#xa;        RETENTION[&quot;Lifecycle Policy&lt;br/&gt;7-Year Retention&lt;br/&gt;Immutable Lock&quot;]&#xa;        INTEGRITY[&quot;Integrity Verification&lt;br/&gt;SHA-256 Validation&lt;br/&gt;Scheduled Audits&quot;]&#xa;        ACCESS_LOG[&quot;Access Logging&lt;br/&gt;Cloud Audit Logs&lt;br/&gt;Tamper Detection&quot;]&#xa;        VERSIONING[&quot;Object Versioning&lt;br/&gt;Enabled&lt;br/&gt;Non-Deletable&quot;]&#xa;    end&#xa;&#xa;    subgraph RETRIEVAL[&quot;Evidence Retrieval &amp; Audit&quot;]&#xa;        style RETRIEVAL fill:#fff9c4,stroke:#f9a825,stroke-width:2px&#xa;        QUERY[&quot;Query Interface&lt;br/&gt;n8n Workflow&lt;br/&gt;Control ID Search&quot;]&#xa;        VERIFY[&quot;Verification Process&lt;br/&gt;Hash Validation&lt;br/&gt;Chain of Custody&quot;]&#xa;        EXPORT[&quot;Export for Assessor&lt;br/&gt;ZIP Package&lt;br/&gt;Signed Manifest&quot;]&#xa;    end&#xa;&#xa;    subgraph MONITORING[&quot;Monitoring &amp; Alerting&quot;]&#xa;        style MONITORING fill:#e1f5fe,stroke:#0288d1,stroke-width:2px&#xa;        CLOUD_LOG[&quot;Cloud Logging&lt;br/&gt;Evidence Upload Events&lt;br/&gt;Access Logs&quot;]&#xa;        ALERT[&quot;Google Chat Alerts&lt;br/&gt;Upload Success/Failure&lt;br/&gt;Integrity Violations&quot;]&#xa;        SCC[&quot;Security Command Center&lt;br/&gt;Compliance Monitoring&lt;br/&gt;Finding Aggregation&quot;]&#xa;    end&#xa;&#xa;    %% Scanning to Collection&#xa;    TRIVY_SCAN --&gt;|&quot;JSON Output&lt;br/&gt;CVE List&quot;| COLLECT&#xa;    GRYPE_SCAN --&gt;|&quot;JSON Output&lt;br/&gt;SBOM + CVEs&quot;| COLLECT&#xa;    SEMGREP_SCAN --&gt;|&quot;JSON Output&lt;br/&gt;SAST Findings&quot;| COLLECT&#xa;    CHECKOV_SCAN --&gt;|&quot;JSON Output&lt;br/&gt;IaC Issues&quot;| COLLECT&#xa;    TFSEC_SCAN --&gt;|&quot;JSON Output&lt;br/&gt;TF Security&quot;| COLLECT&#xa;    SONAR_SCAN --&gt;|&quot;JSON Output&lt;br/&gt;Quality Metrics&quot;| COLLECT&#xa;&#xa;    %% Collection Pipeline&#xa;    COLLECT --&gt;|&quot;Aggregated Results&quot;| ENRICH&#xa;    ENRICH --&gt;|&quot;Enriched Evidence&quot;| HASH&#xa;    HASH --&gt;|&quot;Hashed Evidence&quot;| MAP_CONTROLS&#xa;    MAP_CONTROLS --&gt;|&quot;Control Mapping&quot;| MANIFEST&#xa;&#xa;    %% Storage Operations&#xa;    HASH --&gt;|&quot;Upload Raw Evidence&lt;br/&gt;HTTPS/443&lt;br/&gt;Service Account OAuth2&lt;br/&gt;TLS 1.3&quot;| GCS_RAW&#xa;    MANIFEST --&gt;|&quot;Upload Manifest&lt;br/&gt;HTTPS/443&lt;br/&gt;Service Account OAuth2&lt;br/&gt;TLS 1.3&quot;| GCS_MANIFEST&#xa;    MAP_CONTROLS --&gt;|&quot;Upload Control Evidence&lt;br/&gt;HTTPS/443&lt;br/&gt;Service Account OAuth2&lt;br/&gt;TLS 1.3&quot;| GCS_CONTROLS&#xa;&#xa;    %% Compliance Enforcement&#xa;    GCS_RAW --&gt;|&quot;Apply Policy&quot;| RETENTION&#xa;    GCS_MANIFEST --&gt;|&quot;Apply Policy&quot;| RETENTION&#xa;    GCS_CONTROLS --&gt;|&quot;Apply Policy&quot;| RETENTION&#xa;&#xa;    GCS_RAW --&gt;|&quot;Enable&quot;| VERSIONING&#xa;    GCS_MANIFEST --&gt;|&quot;Enable&quot;| VERSIONING&#xa;    GCS_CONTROLS --&gt;|&quot;Enable&quot;| VERSIONING&#xa;&#xa;    GCS_RAW --&gt;|&quot;Scheduled Check&quot;| INTEGRITY&#xa;    INTEGRITY --&gt;|&quot;Validation Result&quot;| ALERT&#xa;&#xa;    %% Retrieval Process&#xa;    QUERY --&gt;|&quot;Query by Control ID&lt;br/&gt;or Date Range&quot;| GCS_CONTROLS&#xa;    QUERY --&gt;|&quot;Query by Hash&quot;| GCS_RAW&#xa;    GCS_CONTROLS --&gt;|&quot;Retrieve Evidence&quot;| VERIFY&#xa;    GCS_RAW --&gt;|&quot;Retrieve Evidence&quot;| VERIFY&#xa;    VERIFY --&gt;|&quot;Generate Package&quot;| EXPORT&#xa;&#xa;    %% Monitoring Integration&#xa;    GCS_RAW --&gt;|&quot;Access Events&quot;| ACCESS_LOG&#xa;    GCS_MANIFEST --&gt;|&quot;Access Events&quot;| ACCESS_LOG&#xa;    GCS_CONTROLS --&gt;|&quot;Access Events&quot;| ACCESS_LOG&#xa;&#xa;    ACCESS_LOG --&gt;|&quot;Stream Logs&quot;| CLOUD_LOG&#xa;    CLOUD_LOG --&gt;|&quot;Alert on Anomaly&quot;| ALERT&#xa;&#xa;    MAP_CONTROLS --&gt;|&quot;Finding Ingestion&quot;| SCC&#xa;    SCC --&gt;|&quot;Compliance Status&quot;| ALERT&#xa;&#xa;    %% Evidence Flow Annotations&#xa;    HASH -.-&gt;|&quot;SHA-256 Checksum&quot;| HASH&#xa;    MANIFEST -.-&gt;|&quot;Evidence Index&quot;| MANIFEST&#xa;&#xa;    %% Styling&#xa;    classDef scan fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px&#xa;    classDef collect fill:#e3f2fd,stroke:#1976d2,stroke-width:2px&#xa;    classDef store fill:#e8f5e9,stroke:#2e7d32,stroke-width:3px&#xa;    classDef comply fill:#fff3e0,stroke:#f57c00,stroke-width:2px&#xa;    classDef retrieve fill:#fff9c4,stroke:#f9a825,stroke-width:2px&#xa;    classDef monitor fill:#e1f5fe,stroke:#0288d1,stroke-width:2px&#xa;&#xa;    class TRIVY_SCAN,GRYPE_SCAN,SEMGREP_SCAN,CHECKOV_SCAN,TFSEC_SCAN,SONAR_SCAN scan&#xa;    class COLLECT,ENRICH,HASH,MAP_CONTROLS,MANIFEST collect&#xa;    class GCS_RAW,GCS_MANIFEST,GCS_CONTROLS store&#xa;    class RETENTION,INTEGRITY,ACCESS_LOG,VERSIONING comply&#xa;    class QUERY,VERIFY,EXPORT retrieve&#xa;    class CLOUD_LOG,ALERT,SCC monitor" style="shape=mxgraph.mermaid;html=1;verticalAlign=top;align=left;whiteSpace=wrap;labelBackgroundColor=none;" vertex="1" parent="1">
          <mxGeometry x="20" y="20" width="800" height="600" as="geometry"/>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
